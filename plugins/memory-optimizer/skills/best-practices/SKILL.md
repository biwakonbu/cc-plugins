---
name: best-practices
description: メモリ管理のベストプラクティス集。推奨パターン、アンチパターン、実践的なヒントを提供。Use when user asks about best practices, recommended patterns, memory tips, or how to write good memory. Also use when user says ベストプラクティス, 推奨, コツ, ヒント, 良い書き方.
---

# Best Practices スキル

メモリ管理のベストプラクティスとアンチパターンを提供。

## Instructions

このスキルはメモリ管理の推奨パターンと避けるべきパターンを説明します。

---

## ベストプラクティス一覧

### 1. 簡潔さを保つ

**推奨**:
```markdown
## コマンド
- `npm run dev` - 開発サーバー
- `npm test` - テスト実行
```

**避ける**:
```markdown
## 開発コマンドについて
開発を行う際には、以下のコマンドを使用します。
まず、npm run dev コマンドを実行すると開発サーバーが起動します。
このコマンドは Hot Module Replacement をサポートしており...
（長い説明が続く）
```

### 2. 具体的に書く

**推奨**:
```markdown
## 命名規則
- 変数: camelCase（例: `userName`, `isActive`）
- 定数: UPPER_SNAKE（例: `MAX_RETRY_COUNT`）
- クラス: PascalCase（例: `UserService`）
```

**避ける**:
```markdown
## 命名規則
適切な命名を心がけてください。
```

### 3. 階層を活用

**推奨**:
```
project/
├── CLAUDE.md           # 全体ルール（100行）
├── .claude/rules/
│   ├── api.md          # API ルール
│   └── testing.md      # テストルール
└── src/
    └── CLAUDE.md       # src 固有ルール
```

**避ける**:
```
project/
└── CLAUDE.md           # 全部入り（500行）
```

### 4. paths 条件を活用

**推奨**:
```yaml
---
paths:
  - "**/*.test.ts"
---

# テストルール
テストファイルにのみ適用されるルール
```

**避ける**:
```markdown
# テストルール
※ このルールは *.test.ts ファイルにのみ適用してください
（paths 条件を使っていない）
```

### 5. 重複を避ける

**推奨**:
```markdown
# CLAUDE.md
セキュリティについては `.claude/rules/security.md` を参照。
```

**避ける**:
```markdown
# CLAUDE.md
## セキュリティ
- 入力検証必須
...

# .claude/rules/api.md
## セキュリティ（重複）
- 入力検証必須
...
```

---

## アンチパターン

### 1. 巨大な CLAUDE.md

**問題**: 500行以上の単一ファイル

**影響**:
- トークン効率低下
- 読みづらい
- 更新が困難

**対策**: rules フォルダに分離

### 2. 曖昧な指示

**問題**:
```markdown
- 良いコードを書く
- 適切にエラーハンドリング
```

**影響**:
- Claude が判断できない
- 一貫性がない

**対策**: 具体的なルールを記載

### 3. 秘密情報の記載

**問題**:
```markdown
## API Keys
- OpenAI: sk-xxx...
- AWS: AKIA...
```

**影響**:
- セキュリティリスク
- Git に含まれる

**対策**: 環境変数を使用、CLAUDE.local.md に分離

### 4. 過度な細分化

**問題**: 50個の小さな rules ファイル

**影響**:
- 管理困難
- 全体像が見えない

**対策**: 関連ルールを統合

### 5. 更新されない情報

**問題**: 古いコマンドやルールが残っている

**影響**:
- 誤った指示
- 混乱

**対策**: 定期的なレビュー

---

## 実践的なヒント

### ヒント1: テンプレートから始める

新規プロジェクトは以下から開始:

```markdown
# プロジェクト名

## 概要
1-2文で説明

## 技術スタック
- 言語:
- フレームワーク:
- DB:

## コマンド
| コマンド | 説明 |
|---------|------|
| | |

## 規約
- 変数名: camelCase
- コメント: 日本語
```

### ヒント2: 段階的に拡充

```
Week 1: 基本情報のみ
Week 2: コーディング規約追加
Week 3: 必要に応じて rules 分離
Week 4: レビューと最適化
```

### ヒント3: チーム共有

```markdown
# チームでのメモリ管理

1. CLAUDE.md はリポジトリに含める
2. CLAUDE.local.md は各自で設定
3. rules の追加は PR でレビュー
```

### ヒント4: 定期レビュー

```
□ 月次: 内容の正確性確認
□ 四半期: 構成の見直し
□ 年次: 大規模リファクタリング
```

---

## チェックリスト

### CLAUDE.md チェック

```
□ 300行以下か
□ プロジェクト概要があるか
□ 技術スタックが明記されているか
□ 開発コマンドが正確か
□ 秘密情報が含まれていないか
□ 具体的なルールが記載されているか
```

### rules チェック

```
□ 20ファイル以下か
□ 各ファイル200行以下か
□ paths 条件が適切か
□ 重複がないか
□ 命名が分かりやすいか
```

### 全体チェック

```
□ 構成が分かりやすいか
□ 更新しやすいか
□ チームメンバーが理解できるか
□ 実際に Claude の応答が改善されているか
```

---

## 良い例・悪い例

### コーディング規約

**良い例**:
```markdown
## TypeScript 規約

### 型定義
- `any` は禁止（`unknown` を使用）
- 戻り値の型は明示
- オブジェクトは `interface` を使用

### エラー処理
- try-catch は最外層で
- カスタムエラークラスを使用
```

**悪い例**:
```markdown
## TypeScript 規約
TypeScript のベストプラクティスに従ってください。
型安全なコードを書きましょう。
```

### プロジェクト概要

**良い例**:
```markdown
## 概要
EC サイトのバックエンド API。
ユーザー認証、商品管理、注文処理を提供。
```

**悪い例**:
```markdown
## 概要
このプロジェクトは素晴らしいアプリケーションです。
多くの機能があります。
```

---

## Examples

### 新規プロジェクトの設定

```
Q: 新しいプロジェクトのメモリ設定のベストプラクティスを教えて
A: テンプレートから始め、プロジェクト概要、技術スタック、コマンドを記載。
   規模が大きくなったら rules に分離することを推奨します。
```

### 既存プロジェクトの改善

```
Q: 今の CLAUDE.md をベストプラクティスに沿って改善したい
A: まず監査を実施し、肥大化したセクションの分離、曖昧な記述の具体化、
   重複の削除を順に行います。
```
